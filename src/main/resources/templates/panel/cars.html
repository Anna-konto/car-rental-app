<!DOCTYPE html>
<nav style="margin-bottom:15px;">
    <a href="/panel/cars">ğŸš— Samochody</a> |
    <a href="/panel/customers">ğŸ‘¤ Klienci</a> |
    <a href="/panel/rentals">ğŸ“„ WypoÅ¼yczenia</a>
</nav>
<hr>

<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Panel â€“ Samochody</title>

    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 6px;
            text-align: left;
        }
        .AVAILABLE {
            background-color: #e6ffe6;
        }
        .RENTED {
            background-color: #fff3cd;
        }
        .OUT_OF_SERVICE {
            background-color: #ffe6e6;
        }
    </style>

    <a href="/panel/cars/add" class="button">
        â• Dodaj samochÃ³d
    </a>

    <br><br>

</head>
<body>

<h1>ğŸš— Samochody</h1>
<form method="get" action="/panel/cars" style="margin-bottom:15px;">
    <label>Szukaj po rejestracji:</label>
    <input type="text" name="plate" th:value="${plate}">
    <button type="submit">ğŸ” Szukaj</button>
    <a href="/panel/cars">WyczyÅ›Ä‡</a>
</form>
<div style="margin-bottom:15px;">
    <strong>Filtruj:</strong>

    <a href="/panel/cars">Wszystkie</a> |

    <a th:href="@{/panel/cars(status='AVAILABLE', plate=${plate})}">
        âœ… DostÄ™pne
    </a> |

    <a th:href="@{/panel/cars(status='RENTED', plate=${plate})}">
        ğŸš— WypoÅ¼yczone
    </a> |

    <a th:href="@{/panel/cars(status='OUT_OF_SERVICE', plate=${plate})}">
        â›” WyÅ‚Ä…czone
    </a>
</div>

<hr>

<!-- ğŸ“‹ TABELA -->
<h2>Lista samochodÃ³w</h2>

<table>
    <tr>
        <th>ID</th>
        <th>Marka</th>
        <th>Model</th>
        <th>Rejestracja</th>
        <th>Status</th>
        <th>PrzeglÄ…d</th>
        <th>Ubezpieczenie</th>
        <th>Alerty</th>
        <th>Akcja</th>
        <th>Akcje</th>

    </tr>

      <tr th:each="car : ${cars}"
        th:class="${car.status}">

        <td>
            <a th:href="@{'/panel/cars/' + ${car.id}}"
               th:text="${car.id}">
            </a>
        </td>

        <td>
            <a th:href="@{'/panel/cars/' + ${car.id}}"
               th:text="${car.brand}">
            </a>
        </td>

        <td th:text="${car.model}"></td>
    <td>
        <a th:href="@{'/panel/cars/' + ${car.id}}"
           th:text="${car.plateNumber}"></a>
    </td>

    <td th:text="${car.status}"></td>
        <td th:text="${car.technicalInspectionValidUntil}"></td>
        <td th:text="${car.insuranceValidUntil}"></td>
    <td>
        <div th:if="${car.insuranceExpired}" style="color:red;font-weight:bold;">
            âŒ Ubezpieczenie niewaÅ¼ne
        </div>
        <div th:if="${car.insuranceExpiringSoon}" style="color:orange;">
            âš ï¸ Ubezpieczenie koÅ„czy siÄ™
        </div>

        <div th:if="${car.inspectionExpired}" style="color:red;font-weight:bold;">
            âŒ Badanie techniczne niewaÅ¼ne
        </div>
        <div th:if="${car.inspectionExpiringSoon}" style="color:orange;">
            âš ï¸ Badanie techniczne koÅ„czy siÄ™
        </div>
    </td>

        <td>
            <a th:if="${car.canBeRented()}"
               th:href="@{'/panel/rentals/add?carId=' + ${car.id}}">
                ğŸš— WypoÅ¼ycz
            </a>

            <span th:if="${!car.canBeRented()}" style="color:#888;">
   âŒ NiedostÄ™pny
</span>


            <span th:if="${car.status != T(com.carrental.backend.model.CarStatus).AVAILABLE}">
            â€”
        </span>
        </td>
    <td>
        <form th:if="${car.status != T(com.carrental.backend.model.CarStatus).RENTED}"
              th:action="@{'/panel/cars/' + ${car.id} + '/archive'}"
              method="post"
              style="display:inline">
            <button type="submit">ğŸ“¦ Archiwizuj</button>
        </form>

    </td>

</tr>
    <div th:if="${param.error}" style="background-color: #ffebee; color: #c62828; padding: 10px; margin: 10px 0; border-radius: 4px;">
        <span th:if="${param.error[0] == 'missing_dates'}">âš ï¸ Musisz podaÄ‡ datÄ™ wypoÅ¼yczenia i datÄ™ zwrotu!</span>
        <span th:if="${param.error[0] == 'invalid_dates'}">âš ï¸ Data zwrotu nie moÅ¼e byÄ‡ wczeÅ›niejsza niÅ¼ data wypoÅ¼yczenia!</span>
        <span th:if="${param.error[0] == 'missing_price'}">âš ï¸ Podaj cenÄ™ wypoÅ¼yczenia!</span>
        <span th:if="${param.error[0] == 'missing_price_long'}">Podaj cenÄ™ za miesiÄ…c!</span>
        <span th:if="${param.error[0] == 'car_unavailable'}">âš ï¸ SamochÃ³d jest niedostÄ™pny!</span>
    </div>
</table>
<a href="/panel/cars/archived">ğŸ“¦ PrzejdÅº do archiwum</a>
<br><br>

